# BigQuery
## Practice BigQuery + Google Analytics

## Завдання 1. Напиши SQL-запит, який:

1. Створює тимчасову таблицю temp_logs, у якій:

- поле user_id містить ідентифікатор користувача;

- поле details — це STRUCT, що містить два вкладені поля:

event — назва події (наприклад 'search'),
screen — назва екрана (наприклад 'home').

2. Виводить окремо вкладені поля details.event та details.screen.

## Завдання 2. Порахуй кількість унікальних користувачів, які здійснили подію purchase за останні 3 дні включно з сьогодні. Використай фільтр по _PARTITIONDATE

## Завдання 3. Побудуй масив дій користувача через ARRAY_AGG() у межах дня. Згрупуй усі події (event) кожного користувача за датою (DATE(event_time)) і збери їх у масив.

## Завдання 4. Створи STRUCT (вручну або на базі наявного поля) і витягни вкладене туди поле в окремому запиті або СТЕ. Виведи user_id as uid, screen as location.

## Завдання 5. Налаштуй запланований запит (Scheduled Query), який щодня рахує кількість унікальних покупців з '2024-01-01’ (включно) та зберігає результат у нову таблицю.

Що потрібно зробити:

1. Створи Scheduled Query у BigQuery Console.

2. В полі Query встав підготовлений тобою SQL-запит.

У налаштуваннях Scheduled Query вкажи:

Schedule: кожного дня (Daily)
Location type: Multi-region (наприклад, EU)
Destination: “Append to table” (додає нові дані, не видаляючи старі)
Start time: будь-який зручний час (наприклад, 07:00)

## Завдання 6. Оціни вартість одного запиту:

1. Виконай запит з 5 завдання.

2. Зроби скрін із повідомлення “This query will process … MB”.

## Завдання 7. Розгорни масив із Завдання 3 за допомогою UNNEST() і виведи всі унікальні події користувача за день.

## Формат здачі:

- Документ Google Docs або Google Sheet з:

SQL-запитами
короткими коментарями, що робить кожен запит
скріншотами (налаштування Scheduled Query, розрахунок обсягу даних)
- У разі використання власного датасету - додати опис

- Є як мінімум 1 запит з UNNEST, STRUCT

- Є фільтрація за _PARTITIONDATE

- Є приклад з ARRAY_AGG

- Додано приклад з STRUCT (ручне або наявне поле)

- Проведена оцінка обсягу обробки даних

- Вказано, як оптимізовано запит (коментар або SQL)
